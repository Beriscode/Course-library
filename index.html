<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Course Library</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="https://img.icons8.com/ios-filled/50/book.png">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body { font-family: Arial; margin: 0; padding: 0; background: #f0f2f5; }
    header { background: #4A90E2; color: white; padding: 1rem; text-align: center; }
    .container { padding: 1rem; }
    .controls, .preview, .comments, .upload-form, .register-form { margin: 1rem 0; }
    iframe, video { width: 100%; height: 500px; }
    input, button, select, textarea { padding: 0.5rem; margin: 0.5rem 0; width: 100%; }
    .file-card { background: white; padding: 1rem; margin: 1rem 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <header>
    <h1>Course Library</h1>
    <div id="g_id_onload"
         data-client_id="335136086233-b5tvv7va336fh9638cvttm94bhitsou1.apps.googleusercontent.com"
         data-callback="handleCredentialResponse">
    </div>
    <div class="g_id_signin" data-type="standard"></div>
  </header>
  <div class="container">
    <div class="upload-form">
      <h2>Upload File</h2>
      <input type="file" id="fileInput" multiple />
      <button onclick="uploadFiles()">Upload</button>
    </div>
    <div class="register-form">
      <h2>Registration</h2>
      <input type="text" placeholder="Name" />
      <input type="email" placeholder="Email" />
      <button>Register</button>
    </div>
    <div class="controls">
      <h2>Manage Files</h2>
      <input type="text" id="search" placeholder="Search files..." oninput="searchFiles()" />
      <select id="categoryFilter" onchange="filterByCategory()">
        <option value="">All Categories</option>
        <option value="PDF">PDF</option>
        <option value="Video">Video</option>
        <option value="Doc">Document</option>
      </select>
    </div>
    <div id="fileList"></div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
  <script>
    function handleCredentialResponse(response) {
      const data = jwt_decode(response.credential);
      alert('Signed in as: ' + data.name);
    }
    function uploadFiles() {
      const input = document.getElementById('fileInput');
      const files = input.files;
      for (const file of files) {
        const reader = new FileReader();
        reader.onload = () => {
          const div = document.createElement('div');
          div.className = 'file-card';
          div.innerHTML = `
            <h3>${file.name}</h3>
            ${renderFilePreview(file.name, reader.result)}
            <textarea placeholder="Comment..."></textarea>
            <button>Save Comment</button>
          `;
          document.getElementById('fileList').appendChild(div);
        };
        reader.readAsDataURL(file);
      }
    }
    function renderFilePreview(name, url) {
      const ext = name.split('.').pop().toLowerCase();
      if (ext === 'pdf') return `<iframe src="${url}"></iframe>`;
      if (['mp4', 'webm', 'ogg'].includes(ext)) return `<video controls src="${url}"></video>`;
      if (['doc', 'docx', 'ppt', 'pptx'].includes(ext)) return `<iframe src="https://docs.google.com/gview?url=${url}&embedded=true"></iframe>`;
      return `<p>No preview available</p>`;
    }
    function searchFiles() {
      const query = document.getElementById('search').value.toLowerCase();
      const cards = document.querySelectorAll('.file-card');
      cards.forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = text.includes(query) ? '' : 'none';
      });
    }
    function filterByCategory() {
      const value = document.getElementById('categoryFilter').value.toLowerCase();
      const cards = document.querySelectorAll('.file-card');
      cards.forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = value === '' || text.includes(value) ? '' : 'none';
      });
    }
  </script>
</body>
</html>
